# SYSTEM_STATUS

Purpose: single source of truth for what the EverWatt app has today.

Last updated: 2026-02-08

## What features exist (and where)
- Tariff Library + tariff ingestion/snapshots: `src/modules/tariffLibrary/`, `scripts/ingest-ca-tariffs-v0.ts`, `data/tariffs/<utility>/<version>.json`
- Tariff browser UI: `src/pages/TariffBrowserCA.tsx`, `src/pages/RateLibrary.tsx`, `src/pages/UtilitiesAndPrograms*.tsx`
- Billing Engine (v2) + tariff math scaffolding: `src/modules/billingEngineV2/`, `src/modules/tariffEngine/`
- Utility intelligence + rate fit analysis: `src/modules/utilityIntelligence/`
- Program Library (v1) + snapshots: `src/modules/programLibrary/v1/`, `scripts/programs-ingest-ca-v0.ts`, `data/programs/<utility>/<version>.json`
- Analysis flow and reports: `src/pages/NewAnalysis.tsx`, `src/pages/AnalysisResultsV1Page.tsx`, `src/pages/AnalysisReportPage.tsx`, `src/pages/modules/reports/`
- Battery analysis: `src/modules/battery/`, UI in `src/pages/modules/calculators/BatteryCalculator.tsx`
- HVAC optimizer demo + Python service: `src/pages/modules/HVACOptimizer.tsx`, `services/hvac_compute/`
- EE training + academy: `src/pages/modules/EETraining.tsx`, `src/components/ee-training/`
- Project builder + libraries: `src/pages/projectBuilder/`, `src/pages/TechnicalLibrary.tsx`, `src/pages/EquipmentLibrary.tsx`, `src/pages/MeasuresLibrary.tsx`
- API server (Hono): `src/server.ts`

## Canon / featured / hidden (curation)
- Canon: `TariffRateMetadata.isEverWattCanonicalBusiness` and `businessFamilyKey` define the EverWatt Business Canon for prioritized rate families. Source of truth: `src/modules/tariffLibrary/types.ts`.
- Featured: `TariffRateMetadata.popularityTier` uses curated tiers (`top`, `featured`, `common`, `all`). Applied in `src/modules/policy/curation/loadTariffCurationV1.ts`.
- Hidden: `curationHidden` or `curation.hidden` suppresses rates/programs/utilities. Applied in `src/modules/policy/curation/`.
- Tariff curation file: `data/curation/tariffs/ca/ca-tariffs-curation.json` (default for CA).
- Utility/program/implementer curation bundle default path: `data/curation/curation.json` (loaded by `src/modules/policy/curation/loadCuration.ts`; empty bundle if missing).

## Demo mode behavior/defaults
- Analysis results demo mode: `GET /api/projects/:id/analysis-results-v1?demo=true` and `.../analysis-results-v1.pdf?demo=true` in `src/server.ts`.
  - Interval input: `samples/interval_peaky_office.json`
  - Defaults: utility territory `PGE`, rate code `PGE_SIM_B19_LIKE`, project name `Demo: Peaky Office`, site location `Oakland, CA`
- HVAC demo trends: `GET /api/hvac/demo-trends.csv` serves `data/hvac/demo_trends.csv` (generated by `scripts/generate_hvac_trend_csv.py`)

## Current known gaps/bugs (short list)
- No user auth or durable project persistence (see `COMPREHENSIVE_APP_REVIEW.md`).
- Limited end-to-end workflow integration between analysis, calculators, and reports.
- No scenario/what-if comparison tooling across solutions.
- Data quality and validation feedback is limited in the main UI.

## Recent changes
- Added `docs/everwatt-ai/SYSTEM_STATUS.md` and `docs/everwatt-ai/CHAT_HANDOFF.md` as the source-of-truth docs.
- Verified curation defaults and demo inputs via server routes and policy loaders.
